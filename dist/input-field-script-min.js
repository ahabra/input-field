// input-field Web Component. Responsive input field with label and validation
// https://github.com/ahabra/input-field
// Copyright 2021 (C) Abdul Habra. Version 0.5.0.
// Apache License Version 2.0


var InputField=(()=>{var de=Object.defineProperty;var he=(e,t)=>{for(var n in t)de(e,n,{get:t[n],enumerable:!0})};var It={};he(It,{define:()=>ce});var pe=Object.defineProperty,E=(e,t)=>{for(var n in t)pe(e,n,{get:t[n],enumerable:!0})},d={};E(d,{add:()=>Ee,all:()=>M,classPresentIf:()=>xe,createElement:()=>ve,createElements:()=>P,first:()=>ye,getAttributes:()=>be,id:()=>ge,removeElements:()=>Se,setContent:()=>we,tag:()=>H});var w={};E(w,{equals:()=>W,forEachEntry:()=>O,has:()=>Le,isDate:()=>x,isFunction:()=>Ae,isNil:()=>Oe,isString:()=>S});function Oe(e){return e==null}function S(e){return A(e,"String")}function Ae(e){return A(e,"Function")}function x(e){return A(e,"Date")}function A(e,t){return Object.prototype.toString.call(e)===`[object ${t}]`}function O(e,t){if(!(!e||!t)){if(Array.isArray(e)){e.forEach((n,r)=>{t(r,n)});return}Object.entries(e).forEach(n=>t(n[0],n[1]))}}function Le(e,t){return!e||!t?!1:Object.prototype.hasOwnProperty.call(e,t)}function W(e,t){return e===t?!0:e===void 0||t===void 0?!1:Ce(e,t)}function Ce(e,t){return F(e)||F(t)?e===t:Te(e,t)}var $e=new Set(["boolean","number","bigint","string","symbol"]);function F(e){return $e.has(typeof e)}function Te(e,t){return Ne(e,t)?qe(e,t)?!0:je(e,t):!1}function Ne(e,t){return I(e)===I(t)}function I(e){return Object.prototype.toString.call(e)}function qe(e,t){return x(e)&&x(t)?e.getTime()===t.getTime():!1}function je(e,t){let n=Object.keys(e);return n.length!==Object.keys(t).length?!1:n.every(r=>W(e[r],t[r]))}function ge(e,t=document){return L(t)&&(t=t.shadowRoot),t.getElementById(e)}function M(e,t=document){return L(t)&&(t=t.shadowRoot),Array.from(t.querySelectorAll(e))}function ye(e,t=document){if(L(t)&&(t=t.shadowRoot),!e.includes("/"))return t.querySelector(e);let n=e.split("/").map(r=>r.trim()).filter(r=>r.length>0);for(let r of n)if(t=Re(r,t),t===null)break;return t}function Re(e,t){return e==="shadowRoot"||e==="shadow-root"?t.shadowRoot:t.querySelector(e)}function L(e){return e&&e.shadowRoot&&e.tagName.includes("-")}function be(e){let t={},n=e.attributes;if(!n||n.length===0)return t;for(let r=0;r<n.length;r++){let i=n[r];t[i.name]=i.value}return t}function P(e=""){if(e=e.trim(),!e)return[];let t=document.createElement("template");return t.innerHTML=e,Array.from(t.content.childNodes)}function ve(e,t={},n=""){let r=H(e,t,n),i=P(r);return i.length===0?null:i[0]}function H(e,t={},n=""){if(!e)return"";let r=Me(t);return`<${e}${r}>${n}</${e}>`}function Me(e){let t=[];return O(e,(r,i)=>{t.push(`${r}="${i}"`)}),(t.length>0?" ":"")+t.join(" ")}var Pe=new Set(["beforebegin","afterbegin","beforeend","afterend"]);function Ee(e,t,n="beforeend"){return n=n.toLowerCase(),Pe.has(n)?(S(t)?e.insertAdjacentHTML(n,t):He(e,t,n),!0):!1}function He(e,t,n){Array.isArray(t)?t.forEach(r=>e.insertAdjacentElement(n,r)):e.insertAdjacentElement(n,t)}function we(e,...t){e.innerHTML="",e.append(...t)}function Se(e,t=document){M(e,t).forEach(r=>{r.parentNode.removeChild(r)})}function xe(e,t,n){if(!e)return;let r=n?"add":"remove";e.classList[r](t)}var h={};E(h,{endsWith:()=>_,indexOf:()=>C,indexOfFirstMatch:()=>We,indexOfLastMatch:()=>Fe,isEmpty:()=>B,removePrefix:()=>V,removeSuffix:()=>k,removeSurrounding:()=>Ie,replaceTemplate:()=>ke,startsWith:()=>D,substringAfter:()=>De,substringBefore:()=>_e,trim:()=>Ve});function C(e,t,n=0,r=!1){return e?r?e.toLowerCase().indexOf(t.toLowerCase(),n):e.indexOf(t,n):-1}function We(e,t){return!t||!e?-1:e.split("").findIndex(t)}function Fe(e,t){if(!t||!e)return-1;let n=e.split("");for(let r=n.length;r>=0;--r)if(t(n[r],r))return r;return-1}function D(e="",t=void 0,n=!1){if(n){let r=e.substring(0,t.length).toLowerCase();return t.toLowerCase()===r}return e.startsWith(t)}function _(e,t,n=!1){return n?e.toLowerCase().endsWith(t.toLowerCase()):e.endsWith(t)}function V(e,t,n=!1){return D(e,t,n)&&(e=e.substring(t.length)),e}function k(e,t,n=!1){return _(e,t,n)&&(e=e.substring(0,e.length-t.length)),e}function Ie(e,t,n,r=!1){return k(V(e,t,r),n,r)}function De(e,t,n=!1){if(!t)return e;let r=C(e,t,0,n);return r<0?"":e.substring(r+t.length)}function _e(e,t,n=!1){if(!t)return"";let r=C(e,t,0,n);return r<0?e:e.substring(0,r)}function Ve(e){return B(e)?"":(S(e)||(e=String(e)),e.trim(e))}function B(e){return e==null||e===""}function ke(e="",t={},n="${",r="}"){return O(t,(i,s)=>{s!==void 0&&(i=n+i+r,e=e.replaceAll(i,s))}),e}function T({obj:e,prop:t,sel:n,attr:r,root:i,onChange:s}){ze(t),e=e||{};let u=e.hasOwnProperty(t)?e[t]:void 0;i=i||document;let a={};return Object.defineProperty(e,t,{get:()=>z({prop:t,sel:n,attr:r,root:i,objNotBound:a}),set:me=>Be({prop:t,value:me,root:i,sel:n,attr:r,objNotBound:a,onChange:s}),configurable:!0,enumerable:!0}),u!==void 0&&(console.info(`Property '${t}' already exists in object. Will override previous definition but retain old value of ${u}.`),e[t]=u),e}var g=e=>e.type==="checkbox",y=e=>e.type==="radio",G=e=>e.tagName.toLowerCase()==="select",J=e=>"value"in e,K=e=>new Set(Array.isArray(e)?e:[e]);function Be({prop:e,value:t,root:n,sel:r,attr:i,objNotBound:s,onChange:u}){if(Ge({prop:e,value:t,root:n,sel:r,attr:i,objNotBound:s,onChange:u}),r){Je(n,r,t,i);return}s[e]=t}function Ge({prop:e,value:t,root:n,sel:r,attr:i,objNotBound:s,onChange:u}){if(!u)return;let a=z({prop:e,root:n,sel:r,attr:i,objNotBound:s});a!==t&&u(a,t)}function z({prop:e,root:t,sel:n,attr:r,objNotBound:i}){return n?Ke(t,n,r):i[e]}function Ke(e,t,n){let r=Q(e,t);if(r.length===0)return null;let i=r[0];if(n)return i.getAttribute(n);if(!J(i))return i.innerHTML;if(g(i))return r.filter(s=>g(s)&&s.checked).map(s=>s.value==="on"?s.name:s.value);if(G(i))return[...i.querySelectorAll("option")].filter(u=>u.selected).map(u=>u.value);if(!(y(i)&&(i=r.filter(y).find(s=>s.checked),!i)))return i.value}function Je(e,t,n,r){let i=Q(e,t);if(i.length===0)return;let s=i[0];if(g(s)){let u=K(n);i.filter(g).forEach(a=>a.checked=u.has(a.value)||u.has(a.name));return}if(G(s)){let u=K(n);s.querySelectorAll("option").forEach(a=>a.selected=u.has(a.value));return}if(y(s)){i.filter(y).forEach(u=>u.checked=u.value===n);return}i.forEach(u=>Qe(u,n,r))}function Qe(e,t,n){n?e.setAttribute(n,t):J(e)?e.value=t:e.innerHTML=t}function Q(e,t){let n=e.querySelectorAll(t);return n.length===0&&console.warn(`No elements found matching selector ${t}`),[...n]}function ze(e){if(typeof e!="string"||e.length===0)throw"'prop' argument must be a String defining the name a property."}function U({nameWithDash:e,html:t,css:n,display:r,propertyList:i,actionList:s,eventHandlerList:u}){if(customElements.get(e))return!1;let a=class extends HTMLElement{constructor(){super();Ze(this,t,n,r),this.properties=Ue(this,i),this.actions=Xe(this,s),Ye(this,u)}};return customElements.define(e,a),!0}function Ue(e,t){let n={};return tt(t)&&t.forEach(r=>et(n,r,e)),n}function et(e,t,n){let r=nt(t,n);T({obj:e,prop:t.name,sel:t.sel,attr:t.attr,root:n.shadowRoot,onChange:r}),e[t.name]=t.value}function nt(e,t){if(!!e.onChange)return(n,r)=>e.onChange(t,n,r)}function tt(e){if(!e)return!1;if(!Array.isArray(e))throw"propertyList must be an array of {name, value, [sel], [attr]} objects";return!0}function Xe(e,t){let n={};return t&&t.forEach(r=>{r.name&&r.action&&(n[r.name]=r.action.bind(e))}),n}function Ye(e,t){if(!!t){if(!Array.isArray(t))throw"eventHandlerList must be an array of {sel, eventName, listener} objects";t.forEach(n=>{d.all(n.sel,e.shadowRoot).forEach(i=>{i.addEventListener(n.eventName,s=>{n.listener(s,e)})})})}}function Ze(e,t,n,r){t=rt(e,t);let i=e.attachShadow({mode:"open"}),s=d.createElements(it(n,r)+t);i.append(...s)}function rt(e,t){return w.isFunction(t)?t(e):t}function it(e,t){return ut(t)+st(e)}function st(e){return e=h.trim(e),e.length===0?"":(h.startsWith(e,"<style>",!1)||(e=d.tag("style",{},e)),e)}function ut(e){return e=h.trim(e),e.length===0?"":`
  <style>
    :host { display: ${e};}
    :host([hidden]) {display: none;}
  </style>
  `}var ot=Object.defineProperty,$=(e,t)=>{for(var n in t)ot(e,n,{get:t[n],enumerable:!0})},f={};$(f,{add:()=>mt,all:()=>X,classPresentIf:()=>pt,createElement:()=>ct,createElements:()=>Y,first:()=>ft,getAttributes:()=>lt,id:()=>at,removeElements:()=>ht,setContent:()=>dt,tag:()=>Z});var c={};$(c,{equals:()=>te,forEachEntry:()=>q,has:()=>vt,isDate:()=>N,isFunction:()=>yt,isInteger:()=>bt,isNil:()=>gt,isNumber:()=>ee,isString:()=>b});function gt(e){return e==null}function b(e){return v(e,"String")}function yt(e){return v(e,"Function")}function N(e){return v(e,"Date")}function ee(e){return v(e,"Number")?Number.isNaN(e)?!1:Number.isFinite(e):!b(e)||(e=e.trim(),e==="")?!1:!isNaN(e)}function bt(e){return ee(e)?Number.isInteger(Number.parseFloat(e)):!1}function v(e,t){return Object.prototype.toString.call(e)===`[object ${t}]`}function q(e,t){if(!(!e||!t)){if(Array.isArray(e)){e.forEach((n,r)=>{t(r,n)});return}Object.entries(e).forEach(n=>t(n[0],n[1]))}}function vt(e,t){return!e||!t?!1:Object.prototype.hasOwnProperty.call(e,t)}function te(e,t){return e===t?!0:e===void 0||t===void 0?!1:Et(e,t)}function Et(e,t){return ne(e)||ne(t)?e===t:wt(e,t)}var St=new Set(["boolean","number","bigint","string","symbol"]);function ne(e){return St.has(typeof e)}function wt(e,t){return xt(e,t)?Ot(e,t)?!0:At(e,t):!1}function xt(e,t){return re(e)===re(t)}function re(e){return Object.prototype.toString.call(e)}function Ot(e,t){return N(e)&&N(t)?e.getTime()===t.getTime():!1}function At(e,t){let n=Object.keys(e);return n.length!==Object.keys(t).length?!1:n.every(r=>te(e[r],t[r]))}function at(e,t=document){return j(t)&&(t=t.shadowRoot),t.getElementById(e)}function X(e,t=document){return j(t)&&(t=t.shadowRoot),Array.from(t.querySelectorAll(e))}function ft(e,t=document){if(j(t)&&(t=t.shadowRoot),!e.includes("/"))return t.querySelector(e);let n=e.split("/").map(r=>r.trim()).filter(r=>r.length>0);for(let r of n)if(t=Lt(r,t),t===null)break;return t}function Lt(e,t){return e==="shadowRoot"||e==="shadow-root"?t.shadowRoot:t.querySelector(e)}function j(e){return e&&e.shadowRoot&&e.tagName.includes("-")}function lt(e){let t={},n=e.attributes;if(!n||n.length===0)return t;for(let r=0;r<n.length;r++){let i=n[r];t[i.name]=i.value}return t}function Y(e=""){if(e=e.trim(),!e)return[];let t=document.createElement("template");return t.innerHTML=e,Array.from(t.content.childNodes)}function ct(e,t={},n=""){let r=Z(e,t,n),i=Y(r);return i.length===0?null:i[0]}function Z(e,t={},n=""){if(!e)return"";let r=Ct(t);return`<${e}${r}>${n}</${e}>`}function Ct(e){let t=[];return q(e,(r,i)=>{t.push(`${r}="${i}"`)}),(t.length>0?" ":"")+t.join(" ")}var Tt=new Set(["beforebegin","afterbegin","beforeend","afterend"]);function mt(e,t,n="beforeend"){return n=n.toLowerCase(),Tt.has(n)?(b(t)?e.insertAdjacentHTML(n,t):$t(e,t,n),!0):!1}function $t(e,t,n){Array.isArray(t)?t.forEach(r=>e.insertAdjacentElement(n,r)):e.insertAdjacentElement(n,t)}function dt(e,...t){e.innerHTML="",e.append(...t)}function ht(e,t=document){X(e,t).forEach(r=>{r.parentNode.removeChild(r)})}function pt(e,t,n){if(!e)return;let r=n?"add":"remove";e.classList[r](t)}var l={};$(l,{endsWith:()=>se,indexOf:()=>R,indexOfFirstMatch:()=>Nt,indexOfLastMatch:()=>qt,isEmpty:()=>ae,removePrefix:()=>ue,removeSuffix:()=>oe,removeSurrounding:()=>jt,replaceTemplate:()=>Ht,startsWith:()=>ie,substringAfter:()=>Rt,substringBefore:()=>Mt,trim:()=>Pt});function R(e,t,n=0,r=!1){return e?r?e.toLowerCase().indexOf(t.toLowerCase(),n):e.indexOf(t,n):-1}function Nt(e,t){return!t||!e?-1:e.split("").findIndex(t)}function qt(e,t){if(!t||!e)return-1;let n=e.split("");for(let r=n.length;r>=0;--r)if(t(n[r],r))return r;return-1}function ie(e="",t=void 0,n=!1){if(n){let r=e.substring(0,t.length).toLowerCase();return t.toLowerCase()===r}return e.startsWith(t)}function se(e,t,n=!1){return n?e.toLowerCase().endsWith(t.toLowerCase()):e.endsWith(t)}function ue(e,t,n=!1){return ie(e,t,n)&&(e=e.substring(t.length)),e}function oe(e,t,n=!1){return se(e,t,n)&&(e=e.substring(0,e.length-t.length)),e}function jt(e,t,n,r=!1){return oe(ue(e,t,r),n,r)}function Rt(e,t,n=!1){if(!t)return e;let r=R(e,t,0,n);return r<0?"":e.substring(r+t.length)}function Mt(e,t,n=!1){if(!t)return"";let r=R(e,t,0,n);return r<0?e:e.substring(0,r)}function Pt(e){return ae(e)?"":(b(e)||(e=String(e)),e.trim(e))}function ae(e){return e==null||e===""}function Ht(e="",t={},n="${",r="}"){return q(t,(i,s)=>{s!==void 0&&(i=n+i+r,e=e.replaceAll(i,s))}),e}var p=class{constructor(t){this.rules=[],this.add(...t)}add(...t){return t=t.filter(n=>!Ft(this.rules,n.name)),t.length===0?!1:(this.rules.push(...t),t)}validate(t,n){this.rules.forEach(r=>{let i=r.isValid(t);n(i,r.name)})}toHtml(){return this.rules.map(t=>t.toHtml()).join("")}static createFromAttributes(t){let n=[];return Wt(n,t),c.forEachEntry(t,(r,i)=>{if(!l.isEmpty(i)&&c.has(o,r)){let s=t[r+"-message"],u=o[r](i,s);n.push(u)}}),new p(n)}};function Wt(e,t){switch(t.type){case"email":return e.push(o.email(t["email-message"]));case"number":return e.push(o.isNumber(t["number-message"]));case"integer":return e.push(o.isInteger(t["integer-message"]));case"set":return e.push(o.set(t.options,t["set-message"]))}}function Ft(e,t){return!!e.find(r=>r.name===t)}var o=class{constructor(t="",n,r){this.name=t.replace(/[ \\.]/g,"-").toLowerCase(),this.message=n,this.validator=r}isValid(t){return this.validator(String(t))}toHtml(){return l.isEmpty(this.message)?"":`<li class="validation-${this.name}">${this.message}</li>
`}static createRule(t,n,r,i){return n=n.replaceAll("%v",i),new o(t,n,r)}static email(t="Must be a valid email address"){let n=r=>/\S+@\S+\.\S+/.test(r);return new o("email",t,n)}static required(t,n="Required Field"){let r=i=>!!i;return new o("required",n,r)}static minlength(t,n="Minimum Length is %v"){let r=i=>(i?i.length:0)>=t;return o.createRule("minlength",n,r,t)}static pattern(t,n="Must satisfy the pattern %v"){let r=i=>new RegExp(t).test(i);return o.createRule("pattern",n,r,t)}static min(t,n="Minimum value of %v"){t=Number(t)||0;let r=i=>(i=Number(i)||0,i>=t);return o.createRule("minValue",n,r,t)}static max(t,n="Maximum value of %v"){t=Number(t)||0;let r=i=>(i=Number(i)||0,i<=t);return o.createRule("max",n,r,t)}static isNumber(t="Must be a valid number"){let n=r=>c.isNumber(r);return new o("isNumber",t,n)}static isInteger(t="Must be a valid whole number"){let n=r=>c.isInteger(r);return new o("isInteger",t,n)}static set(t,n="Value must be one of [%v]"){let r=new Set(t.split(",").map(s=>s.trim().toLowerCase())),i=s=>s===""||r.has(s.toLowerCase());return o.createRule("set",n,i,t)}};var fe=`\${cssFile}

<div class="input-field">
  <label class="label">
    <span class="superlabel \${required} \${tooltip}">
      \${label} \${tooltipIcon}
      <span class="tooltip-text">\${tooltipText}</span>
    </span>
    <span class="sublabel">\${sublabel}</span>
  </label>
  <input type="\${type}" class="input" value=""
         \${required} \${minlength} \${maxlength} \${pattern}>
  <footer>
    <ul class="rules" style="display:\${showrules};">\${rules}</ul>
  </footer>
</div>
`;function ce(e=""){U({nameWithDash:"input-field",html:t=>{let n=Dt(t);return t.validationRules=p.createFromAttributes(n),_t(n,e,t.validationRules)},propertyList:[{name:"value",value:"",sel:"input",onChange:(t,n,r)=>le(t,r)}],eventHandlerList:[{sel:"input",eventName:"input",listener:(t,n)=>{let r=t.target.value;le(n,r)}},{sel:"label .tooltip",eventName:"click",listener:(t,n)=>{f.first("label .tooltip-text",n).classList.toggle("show")}}],actionList:[{name:"addRule",action:function(t,n,r){let i=new o(t,n,r);!this.validationRules.add(i)||Vt(this,i)}}]})}function Dt(e){let t=f.getAttributes(e),n={};c.forEachEntry(t,(i,s)=>{n[i.toLowerCase()]=s});let r=l.trim(n.showrules).toLowerCase();return n.showrules=r===""||r==="true",n}function _t(e,t,n){let r={cssFile:Bt(t),label:e.label,sublabel:zt(e),type:kt(e),required:m(e,"required"),minlength:m(e,"minlength"),maxlength:m(e,"maxlength"),pattern:m(e,"pattern"),min:m(e,"min"),max:m(e,"max"),showrules:e.showrules?"":"none",rules:n.toHtml()};return Gt(e,r),l.replaceTemplate(fe,r)}function kt(e){let t=l.trim(e.type).toLowerCase();return t?t==="integer"?"number":t:"text"}function Bt(e){return l.isEmpty(e)?"":`<link rel="stylesheet" type="text/css" href="${e}">`}function zt(e){let t=e.sublabel;return t?`<br>${t}`:""}function Gt(e,t){let n=e.tooltip;n?(t.tooltip="tooltip",t.tooltipIcon='<span class="circle">?</span>',t.tooltipText=n):(t.tooltip="",t.tooltipIcon="",t.tooltipText="")}function m(e,t){let n=e[t];return n?n==="required"?n:` ${t}="${n}"`:""}function le(e,t){let n=f.first("footer ul.rules",e),r=!0;e.validationRules.validate(t,(s,u)=>{let a=f.first(`li.validation-${u}`,n);f.classPresentIf(a,"bad",!s),r=r&&s});let i=f.first("input",e);f.classPresentIf(i,"bad",!r)}function Vt(e,t){let n=f.first("footer ul.rules",e);f.add(n,t.toHtml())}return It;})();
